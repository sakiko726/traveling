import streamlit as st

st.title("🌤️ 気温で選ぶおすすめ旅行先（日本）")

# 月ごとの都道府県別平均気温データ
# 気象庁データの簡略版（だいたいの目安）
monthly_temp = {
    1: {"沖縄": 17, "鹿児島": 10, "東京": 6, "大阪": 7, "福岡": 8, "札幌": -3},
    2: {"沖縄": 18, "鹿児島": 11, "東京": 7, "大阪": 8, "福岡": 9, "札幌": -3},
    3: {"沖縄": 20, "鹿児島": 13, "東京": 10, "大阪": 11, "福岡": 11, "札幌": 1},
    4: {"沖縄": 23, "鹿児島": 17, "東京": 15, "大阪": 16, "福岡": 16, "札幌": 7},
    5: {"沖縄": 26, "鹿児島": 20, "東京": 19, "大阪": 20, "福岡": 20, "札幌": 12},
    6: {"沖縄": 29, "鹿児島": 23, "東京": 22, "大阪": 23, "福岡": 23, "札幌": 16},
    7: {"沖縄": 30, "鹿児島": 27, "東京": 26, "大阪": 27, "福岡": 27, "札幌": 20},
    8: {"沖縄": 30, "鹿児島": 28, "東京": 27, "大阪": 28, "福岡": 28, "札幌": 22},
    9: {"沖縄": 29, "鹿児島": 26, "東京": 24, "大阪": 25, "福岡": 25, "札幌": 18},
    10: {"沖縄": 26, "鹿児島": 21, "東京": 18, "大阪": 19, "福岡": 20, "札幌": 12},
    11: {"沖縄": 23, "鹿児島": 16, "東京": 13, "大阪": 14, "福岡": 15, "札幌": 5},
    12: {"沖縄": 19, "鹿児島": 12, "東京": 8, "大阪": 9, "福岡": 10, "札幌": -1},
}

st.subheader("旅行する月を選んでください")
month = st.selectbox("月", list(range(1, 13)))

# 快適とされる気温：15〜25℃
TARGET_TEMP = 20

if st.button("おすすめを表示"):
    temps = monthly_temp[month]

    # 「快適気温20℃」に最も近い都道府県を選ぶ
    best_pref = min(temps, key=lambda x: abs(temps[x] - TARGET_TEMP))
    best_temp = temps[best_pref]

    st.success(f"📅 {month}月におすすめの旅行先は…")
    st.markdown(f"### 🏝️ **{best_pref}（平均気温：{best_temp}℃）**")
    st.caption("快適気温（20℃）に最も近い場所を選んでいます。")

    # 全都道府県ランキングも表示
    st.subheader("気温が近い順ランキング")
    sorted_prefs = sorted(temps.items(), key=lambda x: abs(x[1] - TARGET_TEMP))

    for pref, temp in sorted_prefs:
        st.write(f"{pref}：{temp}℃")

